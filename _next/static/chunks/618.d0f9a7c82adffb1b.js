"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[618],{618:function(e,a,t){t.r(a),t.d(a,{default:function(){return q}});var s=t(5893),n=t(7294),c=t(6784),l=t.n(c),r=t(1485),i=t(7483),o=t(640),d=t(2627),m=t(7258),u=t(1913),h=e=>{let{isOpen:a,onClose:t,blockName:n}=e;if(!a)return null;let c=new m.f({name:n,quantity:1}),r=c.getBiomes(),i=c.getRecipesToCraft(),o=u.Y.items.find(e=>e.name===n);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"".concat(l().blockDetailsOverlay),onClick:t}),(0,s.jsx)("div",{className:"".concat(l().blockDetailsDrawer," ").concat(a?l().open:""),children:(0,s.jsxs)("div",{className:l().blockDetailsContent,children:[(0,s.jsxs)("div",{className:l().blockDetailsHeader,children:[(0,s.jsx)("h2",{children:c.name}),(0,s.jsx)("button",{className:l().closeBtn,onClick:t,children:"\xd7"})]}),(0,s.jsxs)("div",{className:l().blockDetailsBody,children:[(0,s.jsx)("div",{className:l().blockDetailsImage,children:(0,s.jsx)("img",{src:c.getImageUrl(),alt:c.name})}),(0,s.jsxs)("div",{className:l().blockDetailsStat,children:[(0,s.jsx)("span",{className:l().statLabel,children:"Rarity:"}),(0,s.jsx)("span",{className:l().statValue,children:c.getBlock().rarity})]}),(0,s.jsxs)("div",{className:l().blockDetailsStat,children:[(0,s.jsx)("span",{className:l().statLabel,children:"Found in Biomes:"}),(0,s.jsx)("span",{className:l().statValue,children:r.length>0?r.map(e=>e.name).join(", "):"None"})]}),o?(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:l().blockDetailsStat,children:[(0,s.jsx)("span",{className:l().statLabel,children:"Crafting Recipe:"}),(0,s.jsx)("div",{className:l().statValue,children:(0,s.jsx)("ul",{className:l().ingredientsList,children:o.ingredients.map((e,a)=>{let t=new m.f({name:e.item,quantity:e.amount});return(0,s.jsxs)("li",{className:l().ingredientItem,children:[(0,s.jsx)("img",{src:t.getImageUrl(),alt:e.item,className:l().ingredientImage}),(0,s.jsxs)("span",{className:l().ingredientName,children:[e.item," x",e.amount]})]},a)})})})]})}):null,i.length>0?(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:l().blockDetailsStat,children:[(0,s.jsx)("span",{className:l().statLabel,children:"Used to craft:"}),(0,s.jsx)("div",{className:l().statValue,children:(0,s.jsx)("ul",{className:l().ingredientsList,children:i.map((e,a)=>{let t=new m.f({name:e.name,quantity:1});return(0,s.jsxs)("li",{className:l().ingredientItem,children:[(0,s.jsx)("img",{src:t.getImageUrl(),alt:e.name,className:l().ingredientImage}),(0,s.jsx)("span",{className:l().ingredientName,children:e.name})]},a)})})})]})}):null]})]})})]})};let x=e=>{switch(e){case"Common":default:return"#aaaaaa";case"Uncommon":return"#55ff55";case"Rare":return"#5555ff";case"Epic":return"#aa00aa";case"Seasonal":return"#ff5555";case"Legendary":return"#ffaa00"}},p=e=>(0,d.K)("/assets/blocks/".concat(e,".png"));var v=e=>{let{isOpen:a,onClose:t,gameState:c,onBuyItem:r}=e,[i,m]=(0,n.useState)(!0),[u,v]=(0,n.useState)(null),k=(0,n.useRef)(null),g=o.o.items,j=i?g.filter(e=>c.currentBiome.getBiome().availablePickaxes.includes(e.name.toLowerCase())):g;(0,n.useEffect)(()=>{if(a&&k.current){let e=()=>{let e=k.current;e&&(e.scrollHeight>e.clientHeight?e.classList.add(l().hasScroll):e.classList.remove(l().hasScroll))};e();let a=new ResizeObserver(e);return a.observe(k.current),()=>{k.current&&a.unobserve(k.current),a.disconnect()}}},[a,j]);let N=(e,a)=>c.blockInventory.hasBlock(e,a),y=e=>{let{itemType:a,amount:t}=e.cost,s=c.blockInventory.getBlockQuantity(a);return s<t?"Need ".concat(t-s," more ").concat(a):"Buy (".concat(t," ").concat(a,")")};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"".concat(l().biomesOverlay," ").concat(a?l().biomesOverlayOpen:""),onClick:t}),(0,s.jsxs)("div",{className:"".concat(l().biomesDrawer," ").concat(a?l().biomesDrawerOpen:""),children:[(0,s.jsx)("div",{className:l().biomesDrawerHandle,onClick:t}),(0,s.jsxs)("div",{className:l().biomesDrawerHeader,children:[(0,s.jsx)("h2",{children:"Shop Pickaxes"}),(0,s.jsxs)("div",{className:l().toggleContainer,children:[(0,s.jsxs)("label",{className:l().toggleSwitch,children:[(0,s.jsx)("input",{type:"checkbox",checked:i,onChange:()=>{m(e=>!e)}}),(0,s.jsx)("span",{className:l().toggleSlider})]}),(0,s.jsx)("span",{className:l().toggleLabel,children:i?"Showing biome pickaxes only":"Showing all pickaxes"})]})]}),(0,s.jsx)("div",{ref:k,className:l().biomesDrawerContent,"data-drawer-type":"pickaxes",children:(0,s.jsx)("div",{className:l().biomesSection,children:(0,s.jsx)("div",{className:l().pickaxesGrid,children:j.map(e=>{let a=N(e.cost.itemType,e.cost.amount),t=x(e.rarity);p(e.cost.itemType);let n=e.name.charAt(0).toUpperCase()+e.name.slice(1);return(0,s.jsxs)("div",{className:l().pickaxeCard,children:[(0,s.jsx)("div",{className:l().pickaxeCardImageContainer,children:(0,s.jsx)("img",{src:"".concat((0,d.K)("/assets/pickaxes/".concat(e.name.toLowerCase(),".png"))),alt:"".concat(e.name," Pickaxe"),className:l().pickaxeCardImg})}),(0,s.jsxs)("div",{className:l().pickaxeCardInfo,children:[(0,s.jsx)("div",{className:l().pickaxeCardName,children:n}),(0,s.jsx)("div",{className:l().pickaxeCardRarity,style:{color:t},children:e.rarity})]}),(0,s.jsx)("button",{className:"".concat(l().buyPickaxeButton," ").concat(a?"":l().buyPickaxeButtonDisabled),onClick:()=>r(e.name,0),disabled:!a,children:y(e)})]},e.name)})})})})]}),(0,s.jsx)(h,{isOpen:null!==u,onClose:()=>{v(null)},blockName:u||""})]})},k=e=>{let{isOpen:a,onRestart:t}=e;return(0,s.jsx)("div",{className:"".concat(l().modal," ").concat(a?l().modalShow:""),children:(0,s.jsxs)("div",{className:l().modalContent,children:[(0,s.jsx)("h2",{children:"Game Over!"}),(0,s.jsx)("p",{children:"You've lost all your pickaxes!"}),(0,s.jsx)("button",{className:l().restartBtn,onClick:t,children:"Play Again"})]})})},g=e=>{let{onBiomeClick:a,currentPickaxe:t,currentBiome:c,picksToShow:r,minedBlock:i}=e,[o,m]=(0,n.useState)({x:0,y:0}),[u,h]=(0,n.useState)(!1),[x,p]=(0,n.useState)((null==c?void 0:c.currentHealth)||0),[v,k]=(0,n.useState)((0,d.K)("/assets/pickaxes/wood.webp")),[g,j]=(0,n.useState)(!1),[N,y]=(0,n.useState)(null),[b,f]=(0,n.useState)(!1),[C,I]=(0,n.useState)(null),[B,w]=(0,n.useState)([]),S=(0,n.useRef)(null);(0,n.useEffect)(()=>{t&&k(t.getImageUrl())},[t]),(0,n.useEffect)(()=>{if(r){y(r),j(!0);let e=setTimeout(()=>{j(!1)},1500);return()=>clearTimeout(e)}},[r]),(0,n.useEffect)(()=>{if(i){I(i),f(!0),P(i.imageUrl);let e=setTimeout(()=>{f(!1)},1500);return()=>clearTimeout(e)}},[i]);let P=e=>{if(!S.current)return;let a=S.current.getBoundingClientRect(),t=a.width,s=a.height,n=o.x||t/2,c=o.y||s/2,l=Math.floor(5*Math.random())+10,r=[];for(let a=0;a<l;a++){let t=n+(Math.floor(a/3)-1.5)*40+(10*Math.random()-5),l=c+(a%3-1)*40/2+(10*Math.random()-5),i=20*Math.random()+20,o=s-l+100,d=.7+.3*Math.random(),m=.2*Math.random();r.push({id:"block-".concat(Date.now(),"-").concat(a),x:t,y:l,size:i,rotation:0,fallX:0,fallY:o,delay:m,fallDuration:d,imageUrl:e})}w(r),setTimeout(()=>{w([])},2e3)};(0,n.useEffect)(()=>{let e=(null==c?void 0:c.currentHealth)||0;if(e<x&&S.current){let e=S.current;e.classList.add(l().shake),setTimeout(()=>{e.classList.remove(l().shake)},500)}p(e)},[null==c?void 0:c.currentHealth,x]);let D=()=>{h(!0),setTimeout(()=>h(!1),300)},O=(null==c?void 0:c.damagePercent)||100;return(0,s.jsxs)("div",{className:l().biomeContainer,children:[(0,s.jsxs)("div",{ref:S,className:"".concat(l().biome),onMouseMove:e=>{if(S.current){let a=S.current.getBoundingClientRect();m({x:e.clientX-a.left,y:e.clientY-a.top})}},onClick:()=>{a(),D()},style:{backgroundImage:"url(".concat(null==c?void 0:c.getImageUrl(),")"),backgroundSize:"cover",backgroundPosition:"center"},children:[g&&N&&(0,s.jsxs)("div",{className:l().scoreFlash,children:["+",N]}),b&&C&&(0,s.jsx)("div",{className:l().minedBlock,style:{top:"50%",left:"50%",backgroundImage:"url(".concat(C.imageUrl,")"),backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"center"}}),B.map(e=>(0,s.jsx)("div",{className:l().fallingBlock,style:{left:"".concat(e.x,"px"),top:"".concat(e.y,"px"),width:"".concat(e.size,"px"),height:"".concat(e.size,"px"),backgroundImage:"url(".concat(e.imageUrl,")"),backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"center",transform:"rotate(".concat(e.rotation,"deg)"),"--rotation":"".concat(e.rotation,"deg"),"--fall-x":"".concat(e.fallX,"px"),"--fall-y":"".concat(e.fallY,"px"),"--delay":"".concat(e.delay,"s"),"--duration":"".concat(e.fallDuration,"s")}},e.id)),O<100&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:l().crackOverlay,style:{opacity:Math.max(.2,1-O/100),backgroundImage:"url(".concat((0,d.K)("/assets/crack_overlay.png"),")"),transform:"scale(".concat(1+(1-O/100),")"),filter:"contrast(".concat(100+(100-O),"%) brightness(").concat(100+(100-O)/2,"%)")}}),O<50&&(0,s.jsx)("div",{className:"".concat(l().crackOverlay," ").concat(l().secondaryCracks),style:{opacity:Math.max(.1,.8-O/50),backgroundImage:"url(".concat((0,d.K)("/assets/crack_overlay.png"),")"),transform:"scale(".concat(.7+(1-O/50),") rotate(45deg)")}}),O<25&&(0,s.jsx)("div",{className:"".concat(l().crackOverlay," ").concat(l().criticalCracks),style:{opacity:Math.max(.15,.9-O/25),backgroundImage:"url(".concat((0,d.K)("/assets/crack_overlay.png"),")"),transform:"scale(".concat(.9+(1-O/25),") rotate(-30deg)")}})]}),(0,s.jsx)("div",{className:l().pickaxeCursor,style:{left:"".concat(o.x,"px"),top:"".concat(o.y,"px")},children:(0,s.jsx)("img",{src:v,alt:"Pickaxe cursor",className:u?l().swingAnimation:""})})]}),(0,s.jsxs)("div",{className:l().horizontalHealthContainer,children:[(0,s.jsx)("div",{className:l().horizontalHealthBar,style:{width:"".concat(O,"%"),backgroundColor:O>60?"#72CB3B":O>30?"#FFCC00":"#FF6B6B"}}),(0,s.jsxs)("div",{className:l().horizontalHealthText,children:[Math.ceil(O),"%"]})]})]})},j=e=>{let{pickaxe:a,isSelected:t,onClick:c,className:r="",showTooltip:i=!0}=e,[o,d]=(0,n.useState)(!1),m=a.getPickaxe().maxHealth,u=a.health/m*100,h=a.getPickaxe(),x=u<=50?"rgb(".concat(255,", ").concat(Math.round(59+u/50*158),", ").concat(Math.round(59+-(u/50*59)),")"):"rgb(".concat(Math.round(255-(u-50)/50*141),", ").concat(Math.round(217-(u-50)/50*14),", ").concat(Math.round(0+(u-50)/50*59),")");return(0,s.jsxs)("div",{className:"".concat(l().inventorySlot," ").concat(t?l().selected:""," ").concat(r),onClick:()=>{c(a.id)},onMouseEnter:()=>{d(!0)},onMouseLeave:()=>{d(!1)},title:"".concat(a.type," Pickaxe - Health: ").concat(a.health,"/").concat(m),children:[(0,s.jsx)("img",{src:a.getImageUrl(),alt:a.type,className:l().inventoryItem}),(0,s.jsx)("div",{className:l().durabilityBar,children:(0,s.jsx)("div",{className:l().durabilityFill,style:{width:"".concat(u,"%"),backgroundColor:x}})}),i&&o&&(0,s.jsxs)("div",{className:l().quickItemTooltip,children:[(0,s.jsxs)("div",{className:l().quickItemName,children:[a.type.charAt(0).toUpperCase()+a.type.slice(1)," Pickaxe"]}),(0,s.jsxs)("div",{className:l().quickItemStats,children:[(0,s.jsxs)("div",{children:["Health: ",a.health,"/",m]}),(0,s.jsxs)("div",{children:["Strength: ",h.strength]}),(0,s.jsxs)("div",{children:["Critical: ",100*h.critical,"%"]}),(0,s.jsxs)("div",{children:["Power: ",h.power]}),(0,s.jsxs)("div",{children:["Rarity: ",h.rarity]})]})]})]})},N=e=>{let{isOpen:a,onClose:t,gameState:c,onSelectPickaxe:r}=e,i=a?"".concat(l().modal," ").concat(l().modalShow):l().modal,o=c.pickaxeInventory,d=o.currentItem,m=o.getCurrentItem(),[u,h]=(0,n.useState)(d),x=u?o.items.find(e=>e.id===u):m,p=e=>{console.log("handlePickaxePreview",e),h(e)};return(0,s.jsx)("div",{className:i,children:(0,s.jsxs)("div",{className:"".concat(l().modalContent," ").concat(l().shopModalContent),children:[(0,s.jsxs)("div",{className:l().modalHeader,children:[(0,s.jsx)("h2",{children:"Inventory"}),(0,s.jsx)("button",{className:l().closeBtn,onClick:t,children:"\xd7"})]}),(0,s.jsxs)("div",{className:l().inventorySection,children:[(0,s.jsx)("h3",{children:"Pickaxes"}),(0,s.jsx)("div",{className:l().pickaxeGrid,children:o.items.map(e=>(0,s.jsx)(j,{pickaxe:e,isSelected:e.id===u,onClick:p,showTooltip:!1},e.id))})]}),x&&(0,s.jsx)("div",{className:l().inventoryDetails,children:(0,s.jsxs)("div",{className:l().selectedItemDetails,children:[(0,s.jsxs)("h4",{children:[x.type," Pickaxe"]}),(0,s.jsxs)("p",{children:["Health: ",x.health," / ",x.getPickaxe().maxHealth]}),(0,s.jsxs)("p",{children:["Strength: ",x.getPickaxe().strength]}),u!==d&&(0,s.jsx)("button",{className:l().selectButton,onClick:()=>{u&&r&&(console.log("handlePickaxeSelect",u),r(u),t())},children:"Select Pickaxe"}),u===d&&(0,s.jsx)("div",{className:l().currentlyEquipped,children:"Currently Equipped"})]})})]})})},y=t(6335),b=t(9931),f=e=>{let{isOpen:a,onClose:t,gameState:c,onUnlockBiome:r,onSelectBiome:i,selectionMode:o=!1}=e,m=y.a.items,u=c.unlockedBiomes,x=c.currentBiome.type,p=c.currentBiome.currentHealth<=0,v=(0,n.useRef)(null),[k,g]=(0,n.useState)(null);console.log("BiomesModal opened - Selection mode: ".concat(o,", Biome destroyed: ").concat(p,", Current health: ").concat(c.currentBiome.currentHealth)),(0,n.useEffect)(()=>{if(a&&v.current){let e=()=>{let e=v.current;e&&(e.scrollHeight>e.clientHeight?e.classList.add(l().hasScroll):e.classList.remove(l().hasScroll))};e();let a=new ResizeObserver(e);return a.observe(v.current),()=>{v.current&&a.unobserve(v.current),a.disconnect()}}},[a,m]);let j=e=>u.includes(e.toLowerCase()),N=e=>{r&&((0,b.Kz)("Biome","Unlock",e),r(e.toLowerCase()))},f=(e,a)=>{e.stopPropagation(),i&&j(a)&&a.toLowerCase()!==x&&((0,b.Kz)("Biome","Select",a),i(a.toLowerCase()),t())},C=e=>{if(j(e))return!0;let a=y.a.getItemByName(e);return!a.cost||c.blockInventory.hasBlock(a.cost.itemType,a.cost.amount)},I=(e,a)=>{e.stopPropagation(),g(a)};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"".concat(l().biomesOverlay," ").concat(a?l().biomesOverlayOpen:""),onClick:t}),(0,s.jsxs)("div",{className:"".concat(l().biomesDrawer," ").concat(a?l().biomesDrawerOpen:""),children:[(0,s.jsx)("div",{className:l().biomesDrawerHandle,onClick:t}),(0,s.jsx)("div",{className:l().biomesDrawerHeader,children:(0,s.jsx)("h2",{children:o?"Select Biome":"Available Biomes"})}),(0,s.jsx)("div",{ref:v,className:l().biomesDrawerContent,"data-drawer-type":"biomes",children:(0,s.jsx)("div",{className:l().biomesSection,children:(0,s.jsx)("div",{className:l().biomesGrid,children:m.map(e=>{let a=j(e.name),t=C(e.name),n=e.name.toLowerCase()===x;return(0,s.jsxs)("div",{className:"".concat(l().biomeItem," \n                                                ").concat(a?l().biomeUnlocked:l().biomeLocked,"\n                                                ").concat(n?l().biomeSelected:""),children:[(0,s.jsxs)("div",{className:l().biomeImageContainer,children:[(0,s.jsx)("img",{src:(0,d.K)("/assets/biomes/".concat(e.name.toLowerCase(),".png")),alt:e.name,className:l().biomeItemImg}),!a&&(0,s.jsx)("div",{className:l().lockOverlay,children:(0,s.jsx)("img",{src:(0,d.K)("/assets/padlock.svg"),alt:"Locked",className:l().lockIcon})}),(0,s.jsxs)("div",{className:l().biomeNameOverlay,children:[e.name,a&&(0,s.jsx)("span",{className:l().unlockedIndicator,children:"✓"}),n&&(0,s.jsx)("span",{className:l().currentIndicator,children:" (Current)"})]})]}),(0,s.jsxs)("div",{className:l().availableBlocks,children:[(0,s.jsx)("span",{children:"Available Blocks:"}),(0,s.jsx)("div",{className:l().blockImagesContainer,children:e.availableBlocks.map(e=>(0,s.jsxs)("div",{className:l().blockImageWrapper,onClick:a=>I(a,e),style:{cursor:"pointer"},children:[(0,s.jsx)("img",{src:(0,d.K)("/assets/blocks/".concat(e,".png")),alt:e,className:l().blockImage}),(0,s.jsx)("div",{className:l().blockName,children:e})]},e))})]}),(0,s.jsxs)("div",{className:l().availablePickaxes,children:[(0,s.jsx)("span",{children:"Available Pickaxes:"}),(0,s.jsx)("div",{className:l().blockImagesContainer,children:e.availablePickaxes.length>0?e.availablePickaxes.map(e=>(0,s.jsxs)("div",{className:l().blockImageWrapper,children:[(0,s.jsx)("img",{src:(0,d.K)("/assets/pickaxes/".concat(e,".png")),alt:e,className:l().blockImage}),(0,s.jsx)("div",{className:l().blockName,children:e})]},e)):(0,s.jsx)("div",{className:l().noPickaxes,children:"No pickaxes available"})})]}),(0,s.jsxs)("div",{className:l().itemInfo,children:[(0,s.jsx)("div",{className:l().itemDescription,children:e.description}),!a&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:l().unlockCost,children:e.cost?(0,s.jsxs)(s.Fragment,{children:["Cost:",(0,s.jsxs)("div",{className:l().costItemContainer,children:[(0,s.jsxs)("div",{className:l().costItemImgWrapper,children:[(0,s.jsx)("img",{src:(0,d.K)("/assets/blocks/".concat(e.cost.itemType,".png")),alt:e.cost.itemType,className:l().costItemImg}),(0,s.jsx)("span",{className:l().costItemBadge,children:e.cost.amount})]}),(0,s.jsx)("span",{className:t?l().affordableCost:l().unaffordableCost,children:e.cost.itemType.replace(/_/g," ")})]})]}):(0,s.jsx)("span",{className:l().affordableCost,children:"Free"})}),(0,s.jsx)("button",{className:"".concat(l().unlockButton," ").concat(t?"":l().unlockButtonDisabled),onClick:()=>N(e.name),disabled:!t,children:t?"Unlock":"Not enough resources"})]}),a&&o&&!n&&(0,s.jsx)("button",{className:l().selectButton,onClick:a=>f(a,e.name),children:"Select"}),a&&o&&n&&(0,s.jsx)("div",{className:l().currentlyEquipped,children:"Currently Selected"})]})]},e.name)})})})})]}),(0,s.jsx)(h,{isOpen:null!==k,onClose:()=>{g(null)},blockName:k||""})]})},C=e=>{let{block:a,className:t="",showTooltip:c=!0,onClick:r}=e,[i,o]=(0,n.useState)(!1),d=a.getBlock();return(0,s.jsxs)("div",{className:"".concat(l().inventorySlot," ").concat(t),title:"".concat(a.name," - Quantity: ").concat(a.quantity),onMouseEnter:()=>{o(!0)},onMouseLeave:()=>{o(!1)},onClick:()=>{r&&r()},style:{cursor:r?"pointer":"default"},children:[(0,s.jsx)("img",{src:a.getImageUrl(),alt:a.name,className:l().inventoryItem}),(0,s.jsx)("div",{className:l().itemCount,children:a.quantity}),c&&i&&(0,s.jsxs)("div",{className:l().quickItemTooltip,children:[(0,s.jsx)("div",{className:l().quickItemName,children:a.name.charAt(0).toUpperCase()+a.name.slice(1)}),(0,s.jsxs)("div",{className:l().quickItemStats,children:[(0,s.jsxs)("div",{children:["Quantity: ",a.quantity]}),(0,s.jsxs)("div",{children:["Rarity: ",d.rarity]})]})]})]})};function I(e){let{items:a,totalSlots:t,itemType:n,renderItem:c,renderEmptySlot:r}=e,i=[],o=a.length,d=Math.max(1,Math.ceil(o/t));for(let e=0;e<d;e++){let d=Array(t).fill(null);for(let s=0;s<t;s++){let n=e*t+s;n<o&&(d[s]=a[n])}i.push((0,s.jsx)("div",{className:l().quickInventory,children:d.map((a,t)=>a?c(a,e,t):r(e,t))},"".concat(n,"-row-").concat(e)))}return(0,s.jsx)(s.Fragment,{children:i})}var B=e=>{let{gameState:a,onSelectPickaxe:t,onBlockClick:n}=e,c=a.pickaxeInventory,r=a.blockInventory,i=c.currentItem,o=e=>{t&&e&&t(e)},d=e=>{n&&e&&n(e)};return(0,s.jsxs)("div",{className:l().quickInventoryContainer,children:[(0,s.jsxs)("div",{className:l().quickInventorySection,children:[(0,s.jsx)("div",{className:l().quickInventoryLabel,children:"Pickaxes"}),(0,s.jsx)(I,{items:c.items,totalSlots:8,itemType:"pickaxe",renderItem:(e,a,t)=>(0,s.jsx)(j,{pickaxe:e,isSelected:e.id===i,onClick:o},e.id),renderEmptySlot:(e,a)=>(0,s.jsx)("div",{className:l().inventorySlot},"pickaxe-empty-".concat(e,"-").concat(a))})]}),(0,s.jsxs)("div",{className:l().quickInventorySection,children:[(0,s.jsx)("div",{className:l().quickInventoryLabel,children:"Blocks"}),(0,s.jsx)(I,{items:r.items,totalSlots:8,itemType:"block",renderItem:(e,a,t)=>(0,s.jsx)(C,{block:e,onClick:()=>d(e.name)},"block-".concat(e.name,"-").concat(a,"-").concat(t)),renderEmptySlot:(e,a)=>(0,s.jsx)("div",{className:l().inventorySlot},"block-empty-".concat(e,"-").concat(a))})]})]})},w=t(7390),S=t(1499);class P{toggleSound(e){this.soundEnabled=e}preloadSound(e,a){try{let t=new Audio(a);this.sounds.set(e,t)}catch(a){console.error("Error loading sound ".concat(e,": ").concat(a))}}playSound(e){if(this.soundEnabled)try{let a=this.sounds.get(e);a?(a.currentTime=0,a.play().catch(a=>{console.error("Error playing sound ".concat(e,": ").concat(a))})):console.warn('Sound "'.concat(e,'" not found'))}catch(a){console.error("Error playing sound ".concat(e,": ").concat(a))}}constructor(){this.sounds=new Map,this.soundEnabled=!0,this.preloadSound("error","/assets/sounds/error.mp3")}}let D=new P;var O=t(224);let T=e=>{switch(e){case"Common":default:return 100;case"Uncommon":return 200;case"Rare":return 500;case"Legendary":return 2e3}},L=e=>{switch(e){case"Common":default:return"#aaaaaa";case"Uncommon":return"#55ff55";case"Rare":return"#5555ff";case"Legendary":return"#ffaa00"}};var H=e=>{let{isOpen:a,onClose:t,gameState:c,onBuyBlock:r}=e,i=c.currentBiome.getBiome(),o=i.availableBlocks||[],d=(0,n.useRef)(null),[u,x]=(0,n.useState)(null);(0,n.useEffect)(()=>{if(a&&d.current){let e=()=>{let e=d.current;e&&(e.scrollHeight>e.clientHeight?e.classList.add(l().hasScroll):e.classList.remove(l().hasScroll))};e();let a=new ResizeObserver(e);return a.observe(d.current),()=>{d.current&&a.unobserve(d.current),a.disconnect()}}},[a,o]);let p=e=>{x(e)};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"".concat(l().biomesOverlay," ").concat(a?l().biomesOverlayOpen:""),onClick:t}),(0,s.jsxs)("div",{className:"".concat(l().biomesDrawer," ").concat(a?l().biomesDrawerOpen:""),children:[(0,s.jsx)("div",{className:l().biomesDrawerHandle,onClick:t}),(0,s.jsx)("div",{className:l().biomesDrawerHeader,children:(0,s.jsxs)("h2",{children:["Buy Blocks from ",i.name," biome"]})}),(0,s.jsx)("div",{ref:d,className:l().biomesDrawerContent,"data-drawer-type":"blocks",children:(0,s.jsxs)("div",{className:l().biomesSection,children:[(0,s.jsxs)("p",{children:["Your picks: ",c.picks]}),0===o.length?(0,s.jsx)("p",{children:"No blocks available in this biome."}):(0,s.jsx)("div",{className:l().blocksGrid,children:o.map(e=>{let a=new m.f({name:e,quantity:1}),t=a.getImageUrl(),n=a.getBlock().rarity,o=T(n),d=c.picks>=o,u=L(n);return(0,s.jsxs)("div",{className:l().blockItem,onClick:()=>p(e),style:{cursor:"pointer"},children:[(0,s.jsxs)("div",{className:l().blockImageContainer,children:[(0,s.jsx)("img",{src:t,alt:e,className:l().blockItemImg}),(0,s.jsx)("div",{className:l().blockNameOverlay,children:e}),(0,s.jsx)("div",{className:l().rarityBadge,style:{backgroundColor:u},children:n})]}),(0,s.jsxs)("div",{className:l().blockItemContent,children:[(0,s.jsxs)("div",{className:l().blockDescription,children:["A ",n.toLowerCase()," ",e," block from the ",i.name," biome."]}),(0,s.jsx)("button",{className:"".concat(l().buyBlockButton," ").concat(d?"":l().buyBlockButtonDisabled),onClick:a=>{a.stopPropagation(),d&&r(e)},disabled:!d,children:d?"Buy (".concat(o," picks)"):"Need ".concat(o," picks")})]})]},e)})})]})})]}),(0,s.jsx)(h,{isOpen:null!==u,onClose:()=>{x(null)},blockName:u||""})]})},M=e=>{let{isOpen:a,onClose:t,gameState:c}=e,[r,i]=(0,n.useState)(!1);if(!a)return null;let o=w.ZP.exportGameState(c);return(0,s.jsx)("div",{className:l().modal+" "+l().modalShow,children:(0,s.jsxs)("div",{className:l().modalContent,children:[(0,s.jsxs)("div",{className:l().modalHeader,children:[(0,s.jsx)("h2",{children:"Export Game Save"}),(0,s.jsx)("button",{className:l().closeBtn,onClick:t,children:"\xd7"})]}),(0,s.jsxs)("div",{className:l().modalBody,children:[(0,s.jsx)("p",{children:"Copy the code below or download it as a file to save your current game progress:"}),(0,s.jsx)("div",{className:l().exportCodeContainer,children:(0,s.jsx)("textarea",{className:l().exportCode,value:o,readOnly:!0,rows:6})}),(0,s.jsxs)("div",{className:l().exportActions,children:[(0,s.jsx)("button",{className:l().exportActionButton,onClick:()=>{navigator.clipboard.writeText(o),i(!0),setTimeout(()=>i(!1),2e3)},children:r?"Copied!":"Copy to Clipboard"}),(0,s.jsx)("button",{className:l().exportActionButton,onClick:()=>{let e=document.createElement("a"),a=new Blob([o],{type:"text/plain"});e.href=URL.createObjectURL(a),e.download="mathcrafter-save-".concat(Date.now(),".txt"),document.body.appendChild(e),e.click(),document.body.removeChild(e)},children:"Download as File"})]})]})]})})},E=t(1517);function R(e,a){return!!e&&!!e.ingredients&&!!a&&e.ingredients.every(e=>a.getBlockQuantity(e.item)>=e.amount)}var U=e=>{let{isOpen:a,onClose:t,gameState:c,onCraft:r}=e,[i,o]=(0,n.useState)(null),[m,h]=(0,n.useState)(!1),[x,p]=(0,n.useState)(null),v=e=>{o(e),h(!1),p(null)},k=e=>(0,d.K)("/assets/blocks/".concat(e,".png")),g=e=>R(e,c.blockInventory),j=e=>{let a=g(e),t=k(e.name);return(0,s.jsxs)("div",{className:"".concat(l().recipeCard," ").concat(a?l().selectableRecipe:l().unavailableRecipe),onClick:()=>v(e),children:[(0,s.jsxs)("div",{className:l().recipeOutput,children:[(0,s.jsx)("img",{src:t,alt:e.name,className:l().recipeImage}),(0,s.jsx)("div",{className:l().recipeName,children:e.name.replace(/_/g," ")})]}),(0,s.jsx)("div",{className:l().recipeIngredients,children:e.ingredients.map((a,t)=>{let n=k(a.item),r=c.blockInventory.getBlockQuantity(a.item),i=r>=a.amount;return(0,s.jsxs)("div",{className:"".concat(l().ingredientItem," ").concat(i?"":l().missingIngredient),children:[(0,s.jsx)("img",{src:n,alt:a.item,className:l().ingredientImage}),(0,s.jsxs)("div",{className:l().ingredientDetails,children:[(0,s.jsx)("div",{className:l().ingredientName,children:a.item.replace(/_/g," ")}),(0,s.jsxs)("div",{className:l().ingredientAmount,children:[r,"/",a.amount]})]})]},"".concat(e.name,"-").concat(a.item,"-").concat(t))})})]},e.name)};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"".concat(l().biomesOverlay," ").concat(a?l().biomesOverlayOpen:""),onClick:t}),(0,s.jsxs)("div",{className:"".concat(l().biomesDrawer," ").concat(a?l().biomesDrawerOpen:""),children:[(0,s.jsx)("div",{className:l().biomesDrawerHandle,onClick:t}),(0,s.jsx)("div",{className:l().biomesDrawerHeader,children:(0,s.jsx)("h2",{children:"Furnace Recipes"})}),(0,s.jsxs)("div",{className:l().biomesDrawerContent,"data-drawer-type":"furnace",children:[m&&x&&(0,s.jsxs)("div",{className:l().craftingSuccess,children:[(0,s.jsx)("img",{src:k(x),alt:x,className:l().craftedItemImage}),(0,s.jsxs)("div",{className:l().craftedItemText,children:["Successfully crafted ",x.replace(/_/g," "),"!"]})]}),(0,s.jsx)("div",{className:l().recipesContainer,children:u.Y.items.map(e=>j(e))})]})]}),i&&(0,s.jsx)("div",{className:l().recipeDetailsOverlay,onClick:()=>o(null),children:(0,s.jsxs)("div",{className:l().recipeDetailsContainer,onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:l().recipeDetailsHeader,children:[(0,s.jsxs)("h3",{children:["Craft ",i.name.replace(/_/g," ")]}),(0,s.jsx)("button",{className:l().closeBtn,onClick:()=>o(null),children:"\xd7"})]}),(0,s.jsxs)("div",{className:l().recipeDetailsContent,children:[(0,s.jsxs)("div",{className:l().recipeOutputDetails,children:[(0,s.jsx)("img",{src:k(i.name),alt:i.name,className:l().recipeOutputImage}),(0,s.jsx)("div",{className:l().recipeOutputName,children:i.name.replace(/_/g," ")})]}),(0,s.jsxs)("div",{className:l().recipeIngredientsList,children:[(0,s.jsx)("h4",{children:"Required Ingredients:"}),i.ingredients.map((e,a)=>{let t=c.blockInventory.getBlockQuantity(e.item),n=t>=e.amount;return(0,s.jsxs)("div",{className:"".concat(l().recipeIngredientDetail," ").concat(n?"":l().missingIngredientDetail),children:[(0,s.jsx)("img",{src:k(e.item),alt:e.item,className:l().ingredientDetailImage}),(0,s.jsxs)("div",{className:l().ingredientDetailInfo,children:[(0,s.jsx)("div",{className:l().ingredientDetailName,children:e.item.replace(/_/g," ")}),(0,s.jsxs)("div",{className:l().ingredientDetailAmount,children:[t,"/",e.amount]})]})]},"detail-".concat(i.name,"-").concat(e.item,"-").concat(a))})]}),(0,s.jsx)("button",{className:"".concat(l().craftButton," ").concat(g(i)?"":l().craftButtonDisabled),disabled:!g(i),onClick:()=>{i&&g(i)&&(!function(e,a){if(!R(e,a.blockInventory))return console.error("Cannot craft recipe - missing ingredients");let t=a;e.ingredients.forEach(e=>{t=t.withBlockInventory(t.blockInventory.addBlock(e.item,-e.amount))}),t=t.withBlockInventory(t.blockInventory.addBlock(e.name,1)),console.log("Crafted ".concat(e.name," successfully"))}(i,c),r&&r(i),h(!0),p(i.name),setTimeout(()=>{o(null),h(!1)},2e3))},children:g(i)?"Craft Item":"Missing Ingredients"})]})]})})]})},A=e=>{let{isOpen:a,onClose:t,biomeType:c,chest:r,onClaimRewards:i}=e,[o,u]=(0,n.useState)(!1),[h,x]=(0,n.useState)(!1),[p,v]=(0,n.useState)([]);return((0,n.useEffect)(()=>{a&&(u(!1),x(!1))},[a]),a)?(0,s.jsx)("div",{className:l().modalOverlay,children:(0,s.jsxs)("div",{className:l().chestModalContent,children:[(0,s.jsxs)("div",{className:l().modalHeader,children:[(0,s.jsx)("h2",{children:"Biome Chest"}),(0,s.jsx)("button",{className:l().closeBtn,onClick:t,children:"\xd7"})]}),(0,s.jsxs)("div",{className:l().chestContainer,children:[(0,s.jsxs)("h3",{children:["You've conquered the ",c," biome!"]}),h?(0,s.jsxs)("div",{className:l().rewardsContainer,children:[(0,s.jsx)("h3",{children:"You found:"}),(0,s.jsx)("div",{className:l().rewardsList,children:p.length>0?p.map((e,a)=>{let t=e.get(),n=e.getType(),c=e.getAmount();return"block"===n?(0,s.jsxs)("div",{className:l().rewardItem,children:[(0,s.jsx)("div",{className:l().rewardIconContainer,children:(0,s.jsx)("img",{src:new m.f({name:t.name,quantity:1}).getImageUrl(),alt:t.name,className:l().rewardIcon})}),(0,s.jsxs)("div",{className:l().rewardInfo,children:[(0,s.jsx)("span",{className:l().rewardName,children:t.name}),(0,s.jsxs)("span",{className:l().rewardAmount,children:["x",c]})]})]},a):(0,s.jsxs)("div",{className:l().rewardItem,children:[(0,s.jsx)("div",{className:l().rewardIconContainer,children:(0,s.jsx)("img",{src:new S.t({id:null,type:t.name,health:null}).getImageUrl(),alt:t.name,className:l().rewardIcon})}),(0,s.jsxs)("div",{className:l().rewardInfo,children:[(0,s.jsx)("span",{className:l().rewardName,children:t.name}),(0,s.jsxs)("span",{className:l().rewardAmount,children:["x",c]})]})]},a)}):(0,s.jsx)("p",{children:"The chest was empty!"})}),(0,s.jsx)("button",{className:l().claimButton,onClick:()=>{p.length>0&&i(p),t()},children:"Claim Rewards"})]}):(0,s.jsxs)("div",{className:l().chestImageContainer,children:[(0,s.jsx)("img",{src:(0,d.K)("/assets/chests/".concat((null==r?void 0:r.name)||"wooden",".png")),alt:"Chest",className:"".concat(l().chestImage," ").concat(o?l().chestOpening:""),onClick:()=>{u(!0),setTimeout(()=>{r&&v(r.open().filter(e=>e.getAmount()>0)),x(!0)},1e3)}}),(0,s.jsx)("p",{className:l().chestInstructions,children:o?"Opening...":"Click the chest to open it!"})]})]})]})}):null},q=()=>{let[e,a]=(0,n.useState)(!1),[t,c]=(0,n.useState)(w.ZP.loadGameState()),[u,x]=(0,n.useState)({num1:0,num2:0,operator:"+",answer:0}),[p,j]=(0,n.useState)(""),[b,C]=(0,n.useState)(!1),[I,P]=(0,n.useState)(!1),[T,L]=(0,n.useState)(!1),[R,q]=(0,n.useState)(!1),[F,K]=(0,n.useState)(!1),[G,_]=(0,n.useState)(!1),[z,Z]=(0,n.useState)(""),[Y,Q]=(0,n.useState)(!1),[V,W]=(0,n.useState)(""),[X,J]=(0,n.useState)(!1),[$,ee]=(0,n.useState)(!1),[ea,et]=(0,n.useState)(null),[es,en]=(0,n.useState)(null),[ec,el]=(0,n.useState)(null),[er,ei]=(0,n.useState)(null),[eo,ed]=(0,n.useState)(!1),[em,eu]=(0,n.useState)(!1),[eh,ex]=(0,n.useState)(!1),[ep,ev]=(0,n.useState)(!1),[ek,eg]=(0,n.useState)(!1),[ej,eN]=(0,n.useState)(!1),ey=(0,n.useRef)(null),[eb,ef]=(0,n.useState)(null),[eC,eI]=(0,n.useState)(!1),[eB,ew]=(0,n.useState)(null),[eS,eP]=(0,n.useState)(null);(0,n.useEffect)(()=>{a(!0),x(w.ZP.generateMathProblem()),c(w.ZP.loadGameState())},[]),(0,n.useEffect)(()=>{e&&!b&&w.ZP.saveGameState(t)},[t,e,b]),(0,n.useEffect)(()=>{console.log("gameState",t);let e=t.currentBiome;if(e.currentHealth<=0){console.log("Biome destroyed! Opening selection modal..."),W(e.type),Q(!0);let a=e.getChest();ew(e.type),eP(a),eI(!0),setTimeout(()=>{Q(!1)},3e3)}},[t]),(0,n.useEffect)(()=>{F&&ey.current&&setTimeout(()=>{var e;null===(e=ey.current)||void 0===e||e.focus()},100)},[F]);let eD=()=>{x(w.ZP.generateMathProblem()),j(""),ev(!1)},eO=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=!(arguments.length>1)||void 0===arguments[1]||arguments[1],s=t.pickaxeInventory.getCurrentItem();if(!s){console.error("No current pickaxe found");return}et(e=e||s.getPicks()),setTimeout(()=>{et(null)},2e3),eT(),c(t=>{let s=t.pickaxeInventory.getCurrentItem();if(!s)return console.log("No current pickaxe found"),t;let n=t.increasePicks(e||0);if(a){let e=t.currentBiome.withDamage(s.getDamageToBiome(t.currentBiome.getBiome()));return console.log("Biome health: ".concat(e.currentHealth,"/").concat(e.getBiome().maxHealth)),n.withCurrentBiome(e)}return t})},eT=()=>{if(!t.pickaxeInventory.getCurrentItem())return;let e=t.currentBiome;if(!e)return;let a=e.getBiome().availableBlocks,s={Common:[],Uncommon:[],Rare:[],Legendary:[]},n={Common:.55,Uncommon:.3,Rare:.1,Legendary:.05};a.forEach(e=>{let a=E.Z.getItemByName(e);if(null===a){console.error("Block with name ".concat(e," not found"));return}s[a.rarity].push(a)});let c=Object.keys(n).find(e=>Math.random()<=n[e]);if(!c){console.error("No rarity found");return}let l=Math.floor(Math.random()*s[c].length),r=s[c][l];if(!r){console.error("No block found");return}eL(r.name)},eL=e=>{let a=new m.f({name:e,quantity:1});en({name:e,imageUrl:a.getImageUrl()}),el(a),setTimeout(()=>{el(null)},3e3),c(a=>{let t=a.blockInventory.addBlock(e,1);return a.withBlockInventory(t)})},eH=()=>{J(!0),ee(!0),D.playSound("error"),document.body.classList.add("screen-shake"),setTimeout(()=>{ee(!1)},1e3),setTimeout(()=>{J(!1),document.body.classList.remove("screen-shake")},500),c(e=>{let a=e.pickaxeInventory.getCurrentItem();if(null===a)return e;let t=a.withDamage(1),s=new S.t({id:t.id,type:t.type,health:t.health});if(s.health<=0)return eM(e);let n=e.pickaxeInventory.withCurrentItem(s);return e.withPickaxeInventory(n)})},eM=e=>{let a=e.pickaxeInventory.getCurrentItem();if(!a)return e;if(Z(a.type),_(!0),setTimeout(()=>{_(!1)},3e3),e.pickaxeInventory.length<=1)return C(!0),e;let t=e.pickaxeInventory.removeCurrentItem();return e.withPickaxeInventory(t)},eE=()=>{P(e=>!e)},eR=()=>{L(e=>!e)},eU=()=>{q(e=>!e)},eA=()=>{ed(e=>!e)},eq=()=>{eu(e=>!e)},eF=()=>{ex(e=>!e)},eK=e=>{if(!t.pickaxeInventory.items.find(a=>a.id===e)){console.error("Selected pickaxe not found in inventory");return}let a=t.pickaxeInventory.withCurrentItemId(e);c(e=>{let t=e.withPickaxeInventory(a);return setTimeout(()=>{w.ZP.saveGameState(t)},0),t}),L(!1)},eG=e=>{switch(e){case"Common":default:return 100;case"Uncommon":return 200;case"Rare":return 500;case"Legendary":return 2e3}};return(t.pickaxeInventory.length,e)?(0,s.jsxs)("div",{className:l().gameContainer,children:[(0,s.jsxs)("div",{className:l().gameHeader,children:[(0,s.jsx)("h1",{children:"MathCrafter"}),(0,s.jsx)("div",{className:l().avatar,children:(0,s.jsx)("img",{src:(0,d.K)("/assets/avatars/avatar.png"),alt:"Player Avatar",className:l().avatarImage,onClick:eR,style:{cursor:"pointer"}})}),(0,s.jsx)("div",{className:l().stats,children:(0,s.jsxs)("div",{className:l().statItem,children:[(0,s.jsx)("img",{src:(0,d.K)("/assets/picks.png"),alt:"Picks",className:l().picksIcon}),(0,s.jsx)("span",{children:t.picks})]})}),(0,s.jsxs)("div",{className:l().headerButtons,children:[(0,s.jsx)("button",{className:l().pickaxesButton,onClick:eE,children:"Pickaxes"}),(0,s.jsx)("button",{className:l().unlockBiomesButton,onClick:eU,children:"Biomes"}),(0,s.jsx)("button",{className:l().buyBlocksButton,onClick:eA,children:"Blocks"}),(0,s.jsx)("button",{className:l().furnaceButton,onClick:eF,children:"Furnace"}),(0,s.jsx)("button",{className:l().exportGameButton,onClick:eq,children:"Export"})]})]}),(0,s.jsxs)("div",{className:l().gameArea,children:[(0,s.jsx)(g,{onBiomeClick:()=>{if(F)return;let e=t.pickaxeInventory.getCurrentItem();e&&(e.getPickaxe().critical,eD(),K(!0))},currentPickaxe:t.pickaxeInventory.getCurrentItem(),currentBiome:t.currentBiome,picksToShow:ea,minedBlock:es}),(0,s.jsx)(B,{gameState:t,onSelectPickaxe:eK,onBlockClick:e=>{ef(e)}})]}),(0,s.jsx)("div",{className:"".concat(l().modal," ").concat(F?l().modalShow:""),children:(0,s.jsxs)("div",{className:"".concat(l().modalContent," ").concat(l().questionModalContent),children:[(0,s.jsx)("div",{className:l().modalHeader,children:(0,s.jsx)("h2",{children:"Math Problem"})}),(0,s.jsxs)("form",{className:"".concat(l().mathProblem," ").concat(X?l().wrongAnswerShake+" "+l().wrongAnswerFlash:""),onSubmit:e=>{e.preventDefault();let a=parseInt(p);isNaN(a)||(a===u.answer?(eO(null,!0),eD(),j(""),K(!1)):(eH(),j("")))},children:[(0,s.jsxs)("div",{className:l().question,children:[u.num1," ","*"===u.operator?"\xd7":u.operator," ",u.num2," = ?"]}),ek&&(0,s.jsx)("div",{className:l().notEnoughPicks,children:"Not enough picks! Need 500 picks for a hint."}),(0,s.jsxs)("div",{className:l().answerArea,children:[(0,s.jsx)("input",{ref:ey,type:"number",className:"".concat(l().answer," ").concat(ej?l().hintAnswer:""),value:p,onChange:e=>j(e.target.value),readOnly:ej,autoFocus:!0}),(0,s.jsx)("div",{className:l().buttonGroup,children:(0,s.jsx)("button",{type:"submit",className:l().submitBtn,children:"Mine!"})})]}),(0,s.jsxs)("div",{className:l().numpad,children:[[7,8,9,4,5,6,1,2,3,0].map(e=>(0,s.jsx)("button",{type:"button",className:l().numpadBtn,onClick:()=>j(a=>a+e.toString()),children:e},e)),(0,s.jsxs)("button",{type:"button",className:"".concat(l().numpadBtn," ").concat(l().hintBtn," ").concat(t.picks<500?l().hintBtnDisabled:""),onClick:()=>{if(t.picks<500){eg(!0),setTimeout(()=>{eg(!1)},2e3);return}c(e=>e.increasePicks(-500)),ev(!0),eN(!0),j(u.answer.toString()),setTimeout(()=>{var e;eN(!1),j(""),null===(e=ey.current)||void 0===e||e.focus()},2e3)},disabled:t.picks<500,children:["Hint (",500,")"]}),(0,s.jsx)("button",{type:"button",className:"".concat(l().numpadBtn," ").concat(l().clearBtn),onClick:()=>j(""),children:"Clear"}),(0,s.jsx)("button",{type:"button",className:"".concat(l().numpadBtn," ").concat(l().deleteBtn),onClick:()=>j(e=>e.slice(0,-1)),children:"←"})]})]})]})}),$&&(0,s.jsx)("div",{className:l().incorrectText,children:"INCORRECT!"}),(0,s.jsx)(v,{isOpen:I,onClose:eE,gameState:t,onBuyItem:(e,a)=>{let s=o.o.getItemByName(e);if(!s){console.error("Pickaxe with name ".concat(e," not found"));return}let n=s.cost.itemType,l=s.cost.amount;if(!t.blockInventory.hasBlock(n,l)){console.error("Not enough ".concat(n," to craft ").concat(e," pickaxe"));return}let r=new S.t({id:null,type:e,health:null}),i=t.blockInventory;i=i.addBlock(n,-l);let d=new O.C0({items:[...t.pickaxeInventory.items,r],currentItem:r.id});c(t.withPickaxeInventory(d).withBlockInventory(i))}}),(0,s.jsx)(N,{isOpen:T,onClose:eR,gameState:t,onSelectPickaxe:eK}),(0,s.jsx)(f,{isOpen:R,onClose:eU,gameState:t,onUnlockBiome:e=>{if(t.unlockedBiomes.includes(e))return;let a=y.a.getItemByName(e);if(!a){console.error("Biome with name ".concat(e," not found"));return}if(a.cost){let s=a.cost.itemType,n=a.cost.amount;if(!t.blockInventory.hasBlock(s,n)){console.error("Not enough ".concat(s," to unlock ").concat(e," biome"));return}c(a=>{let t=a.blockInventory;t=t.addBlock(s,-n);let c=[...a.unlockedBiomes,e];return new r.D({...a,unlockedBiomes:c,blockInventory:t})})}else c(a=>{let t=[...a.unlockedBiomes,e];return new r.D({...a,unlockedBiomes:t})})},onSelectBiome:e=>{c(a=>{let t=new i.k({id:null,type:e,currentHealth:null,chest:null});return a.withCurrentBiome(t)})},selectionMode:!0}),(0,s.jsx)(H,{isOpen:eo,onClose:eA,gameState:t,onBuyBlock:e=>{console.log("handleBuyBlock",e);let a=E.Z.getItemByName(e);if(a){let s=eG(a.rarity);t.picks>=s&&(c(t.increasePicks(-s).withBlockInventory(t.blockInventory.addBlock(e,1))),D.playSound("buy"))}}}),(0,s.jsx)(M,{isOpen:em,onClose:eq,gameState:t}),(0,s.jsx)(U,{isOpen:eh,onClose:eF,gameState:t,onCraft:e=>{console.log("handleCraftRecipe",e),D.playSound("craft"),el(new m.f({name:e.name,quantity:1})),setTimeout(()=>{el(null)},2e3),c(e=>new r.D({pickaxeInventory:e.pickaxeInventory,blockInventory:e.blockInventory,picks:e.picks,unlockedBiomes:e.unlockedBiomes,currentBiome:e.currentBiome}))}}),(0,s.jsx)(k,{isOpen:b,onRestart:()=>{let e=w.ZP.loadGameState();c(e),C(!1),K(!1),eD(),w.ZP.saveGameState(e)}}),G&&(0,s.jsxs)("div",{className:l().brokenPickaxeNotification,children:[(0,s.jsx)("h3",{children:"Pickaxe Destroyed!"}),(0,s.jsxs)("p",{children:["Your ",z," Pickaxe has broken."]})]}),Y&&(0,s.jsxs)("div",{className:l().biomeDestroyedNotification,children:[(0,s.jsx)("h3",{children:"Biome Conquered!"}),(0,s.jsxs)("p",{children:["You've mined the ",V," biome."]}),(0,s.jsx)("p",{children:"Please select a new biome to explore!"})]}),(0,s.jsx)(A,{isOpen:eC,onClose:()=>{eI(!1),c(e=>{let a=new i.k({id:null,type:e.currentBiome.type,currentHealth:null,chest:null});return e.withCurrentBiome(a)}),q(!0)},biomeType:eB,chest:eS,onClaimRewards:e=>{e.forEach(e=>{if(e.getAmount()>0){if("pickaxe"===e.getType()){let a=e.get().name;for(let t=0;t<e.getAmount();t++){let e=new S.t({id:null,type:a,health:null});c(a=>{let t=new O.C0({items:[...a.pickaxeInventory.items,e],currentItem:a.pickaxeInventory.currentItem});return a.withPickaxeInventory(t)}),ei(e)}}else c(a=>{let t=a.blockInventory.addBlock(e.get().name,e.getAmount());return a.withBlockInventory(t)}),el(new m.f({name:e.get().name,quantity:e.getAmount()}));setTimeout(()=>{el(null)},3e3)}}),eI(!1),c(e=>{let a=new i.k({id:null,type:e.currentBiome.type,currentHealth:null,chest:null});return e.withCurrentBiome(a)}),q(!0)}}),ec&&(0,s.jsxs)("div",{className:l().blockAddedNotification,children:[(0,s.jsx)("img",{src:ec.getImageUrl(),alt:ec.name}),(0,s.jsx)("div",{children:(0,s.jsxs)("div",{children:["+1 ",ec.name]})})]}),er&&(0,s.jsxs)("div",{className:l().pickaxeAddedNotification,children:[(0,s.jsx)("img",{src:er.getImageUrl(),alt:er.getPickaxe().name}),(0,s.jsx)("div",{children:(0,s.jsxs)("div",{children:["+1 ",er.getPickaxe().name]})})]}),(0,s.jsx)(h,{isOpen:null!==eb,onClose:()=>{ef(null)},blockName:eb||""})]}):(0,s.jsx)("div",{className:l().gameContainer,children:"Loading..."})}}}]);